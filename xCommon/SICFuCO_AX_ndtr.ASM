
; FASM SOURCE FILE
; http://flatassembler.net

; <SI>mple <C>ompiler
; function constants

; Copyright © 2000-3000, Andrey A. Meshkov (AL-CHEMIST)
; All rights reserved
;
; http://maalchemist.ru
; http://maalchemist.narod.ru
; maa@maalchemist.ru
; maalchemist@yandex.ru
; maalchemist@gmail.com

; ------------------------------------------------------------------------------

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/ndtr.c
; Normal distribution function
; Error function
; Complementary error function

; ndtr(x) = (1 + erf(z))/2, |z| < 1
; ndtr(x) = erfc(z)/2, |z| >= 1
; z = x/sqrt(2)

; erf(x) = x * T(x^2)/U(x^2), |x| < 1
; erf(x) = 1 - erfc(x), |x| >= 1
;
; T =      5.55923013010394962768E+4 +  // T5
;   (x^2)*(7.00332514112805075473E+3 +  // T4
;   (x^2)*(2.23200534594684319226E+3 +  // T3
;   (x^2)*(9.00260197203842689217E+1 +  // T2
;   (x^2)*(9.60497373987051638749E+0 +  // T1
;   (x^2)*(0.00000000000000000000E+0 )) // T0
;
; U =      4.92673942608635921086E+4 +  // U5
;   (x^2)*(2.26290000613890934246E+4 +  // U4
;   (x^2)*(4.59432382970980127987E+3 +  // U3
;   (x^2)*(5.21357949780152679795E+2 +  // U2
;   (x^2)*(3.35617141647503099647E+1 +  // U1
;   (x^2)*(1.00000000000000000000E+0 )) // U0

; erfc(x) = exp(-x^2) * P(x)/Q(x), 1 <= |x| < 8
; erfc(x) = exp(-x^2) * R(x)/S(x), |x| >= 8
; erfc(x) = 1 - erf(x), |x| < 1
;
; P =    5.57535335369399327526E+2 +    // P8
;   (x)*(1.02755188689515710272E+3 +    // P7
;   (x)*(9.34528527171957607540E+2 +    // P6
;   (x)*(5.26445194995477358631E+2 +    // P5
;   (x)*(1.96520832956077098242E+2 +    // P4
;   (x)*(4.86371970985681366614E+1 +    // P3
;   (x)*(7.46321056442269912687E+0 +    // P2
;   (x)*(5.64189564831068821977E-1 +    // P1
;   (x)*(2.46196981473530512524E-10))   // P0
;
; Q =    5.57535340817727675546E+2 +    // Q8
;   (x)*(1.65666309194161350182E+3 +    // Q7
;   (x)*(2.24633760818710981792E+3 +    // Q6
;   (x)*(1.82390916687909736289E+3 +    // Q5
;   (x)*(9.75708501743205489753E+2 +    // Q4
;   (x)*(3.54937778887819891062E+2 +    // Q3
;   (x)*(8.67072140885989742329E+1 +    // Q2
;   (x)*(1.32281951154744992508E+1 +    // Q1
;   (x)*(1.00000000000000000000E+0 ))   // Q0
;
; R =    2.97886665372100240670E+0 +    // R6
;   (x)*(7.40974269950448939160E+0 +    // R5
;   (x)*(6.16021097993053585195E+0 +    // R4
;   (x)*(5.01905042251180477414E+0 +    // R3
;   (x)*(1.27536670759978104416E+0 +    // R2
;   (x)*(5.64189583547755073984E-1 +    // R1
;   (x)*(0.00000000000000000000E+0 ))   // R0
;
; S =    3.36907645100081516050E+0 +    // S6
;   (x)*(9.60896809063285878198E+0 +    // S5
;   (x)*(1.70814450747565897222E+1 +    // S4
;   (x)*(1.20489539808096656605E+1 +    // S3
;   (x)*(9.39603524938001434673E+0 +    // S2
;   (x)*(2.26052863220117276590E+0 +    // S1
;   (x)*(1.00000000000000000000E+0 ))   // S0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_ferfc_PQ:
v64bit  ??.PD_ferfc_P0 , 0x3DF0EB24A24F6479 ,\ ; 2.46196981473530512524E-10
        ??.PD_ferfc_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_ferfc_P1 , 0x3FE20DD746363488 ,\ ; 5.64189564831068821977E-1
        ??.PD_ferfc_Q1 , 0x402A74D5FD7C23CC ,\ ; 1.32281951154744992508E+1
        ??.PD_ferfc_P2 , 0x401DDA53DEC56DC4 ,\ ; 7.46321056442269912687E+0
        ??.PD_ferfc_Q2 , 0x4055AD42FEE17365 ,\ ; 8.67072140885989742329E+1
        ??.PD_ferfc_P3 , 0x4048518FACADBA66 ,\ ; 4.86371970985681366614E+1
        ??.PD_ferfc_Q3 , 0x40762F01246F610D ,\ ; 3.54937778887819891062E+2
        ??.PD_ferfc_P4 , 0x406890AAA9E020F7 ,\ ; 1.96520832956077098242E+2
        ??.PD_ferfc_Q4 , 0x408E7DAB02F641D0 ,\ ; 9.75708501743205489753E+2
        ??.PD_ferfc_P5 , 0x4080738FC264CF58 ,\ ; 5.26445194995477358631E+2
        ??.PD_ferfc_Q5 , 0x409C7FA2FCA47151 ,\ ; 1.82390916687909736289E+3
        ??.PD_ferfc_P6 , 0x408D343A6C7434D8 ,\ ; 9.34528527171957607540E+2
        ??.PD_ferfc_Q6 , 0x40A18CACDAFAF4FF ,\ ; 2.24633760818710981792E+3
        ??.PD_ferfc_P7 , 0x40900E3521D6972A ,\ ; 1.02755188689515710272E+3
        ??.PD_ferfc_Q7 , 0x4099E2A70192EDE2 ,\ ; 1.65666309194161350182E+3
        ??.PD_ferfc_P8 , 0x40816C485DE8FFB3 ,\ ; 5.57535335369399327526E+2
        ??.PD_ferfc_Q8 , 0x40816C4860C442D6    ; 5.57535340817727675546E+2

$align 16
??.SD_ferfc_Pn:
v64bit  ??.SD_ferfc_P0 , 0x3DF0EB24A24F6479 ,\ ; 2.46196981473530512524E-10
        ??.SD_ferfc_P1 , 0x3FE20DD746363488 ,\ ; 5.64189564831068821977E-1
        ??.SD_ferfc_P2 , 0x401DDA53DEC56DC4 ,\ ; 7.46321056442269912687E+0
        ??.SD_ferfc_P3 , 0x4048518FACADBA66 ,\ ; 4.86371970985681366614E+1
        ??.SD_ferfc_P4 , 0x406890AAA9E020F7 ,\ ; 1.96520832956077098242E+2
        ??.SD_ferfc_P5 , 0x4080738FC264CF58 ,\ ; 5.26445194995477358631E+2
        ??.SD_ferfc_P6 , 0x408D343A6C7434D8 ,\ ; 9.34528527171957607540E+2
        ??.SD_ferfc_P7 , 0x40900E3521D6972A ,\ ; 1.02755188689515710272E+3
        ??.SD_ferfc_P8 , 0x40816C485DE8FFB3    ; 5.57535335369399327526E+2

$align 16
??.SD_ferfc_Qn:
v64bit  ??.SD_ferfc_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_ferfc_Q1 , 0x402A74D5FD7C23CC ,\ ; 1.32281951154744992508E+1
        ??.SD_ferfc_Q2 , 0x4055AD42FEE17365 ,\ ; 8.67072140885989742329E+1
        ??.SD_ferfc_Q3 , 0x40762F01246F610D ,\ ; 3.54937778887819891062E+2
        ??.SD_ferfc_Q4 , 0x408E7DAB02F641D0 ,\ ; 9.75708501743205489753E+2
        ??.SD_ferfc_Q5 , 0x409C7FA2FCA47151 ,\ ; 1.82390916687909736289E+3
        ??.SD_ferfc_Q6 , 0x40A18CACDAFAF4FF ,\ ; 2.24633760818710981792E+3
        ??.SD_ferfc_Q7 , 0x4099E2A70192EDE2 ,\ ; 1.65666309194161350182E+3
        ??.SD_ferfc_Q8 , 0x40816C4860C442D6    ; 5.57535340817727675546E+2

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_ferfc_RS:
v64bit  ??.PD_ferfc_R0 , 0x0000000000000000 ,\ ; 0.0
        ??.PD_ferfc_S0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_ferfc_R1 , 0x3FE20DD750429B62 ,\ ; 5.64189583547755073984E-1
        ??.PD_ferfc_S1 , 0x400215900917CE21 ,\ ; 2.26052863220117276590E+0
        ??.PD_ferfc_R2 , 0x3FF467E6EBB8C5A6 ,\ ; 1.27536670759978104416E+0
        ??.PD_ferfc_S2 , 0x4022CAC521D84CFD ,\ ; 9.39603524938001434673E+0
        ??.PD_ferfc_R3 , 0x40141381F436A71A ,\ ; 5.01905042251180477414E+0
        ??.PD_ferfc_S3 , 0x402819107F052C4D ,\ ; 1.20489539808096656605E+1
        ??.PD_ferfc_R4 , 0x4018A40E58DD0C0C ,\ ; 6.16021097993053585195E+0
        ??.PD_ferfc_S4 , 0x403114D9959C7FF5 ,\ ; 1.70814450747565897222E+1
        ??.PD_ferfc_R5 , 0x401DA3939718960E ,\ ; 7.40974269950448939160E+0
        ??.PD_ferfc_S5 , 0x402337CAAA6326C1 ,\ ; 9.60896809063285878198E+0
        ??.PD_ferfc_R6 , 0x4007D4B80A470367 ,\ ; 2.97886665372100240670E+0
        ??.PD_ferfc_S6 , 0x400AF3DE5AB62D90    ; 3.36907645100081516050E+0

$align 16
??.SD_ferfc_Rn:
v64bit  ??.SD_ferfc_R0 , 0x0000000000000000 ,\ ; 0.0
        ??.SD_ferfc_R1 , 0x3FE20DD750429B62 ,\ ; 5.64189583547755073984E-1
        ??.SD_ferfc_R2 , 0x3FF467E6EBB8C5A6 ,\ ; 1.27536670759978104416E+0
        ??.SD_ferfc_R3 , 0x40141381F436A71A ,\ ; 5.01905042251180477414E+0
        ??.SD_ferfc_R4 , 0x4018A40E58DD0C0C ,\ ; 6.16021097993053585195E+0
        ??.SD_ferfc_R5 , 0x401DA3939718960E ,\ ; 7.40974269950448939160E+0
        ??.SD_ferfc_R6 , 0x4007D4B80A470367    ; 2.97886665372100240670E+0

$align 16
??.SD_ferfc_Sn:
v64bit  ??.SD_ferfc_S0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_ferfc_S1 , 0x400215900917CE21 ,\ ; 2.26052863220117276590E+0
        ??.SD_ferfc_S2 , 0x4022CAC521D84CFD ,\ ; 9.39603524938001434673E+0
        ??.SD_ferfc_S3 , 0x402819107F052C4D ,\ ; 1.20489539808096656605E+1
        ??.SD_ferfc_S4 , 0x403114D9959C7FF5 ,\ ; 1.70814450747565897222E+1
        ??.SD_ferfc_S5 , 0x402337CAAA6326C1 ,\ ; 9.60896809063285878198E+0
        ??.SD_ferfc_S6 , 0x400AF3DE5AB62D90    ; 3.36907645100081516050E+0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_ferf_TU:
v64bit  ??.PD_ferf_T0 , 0x0000000000000000 ,\ ; 0.0
        ??.PD_ferf_U0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_ferf_T1 , 0x402335BF1E375D88 ,\ ; 9.60497373987051638749E+0
        ??.PD_ferf_U1 , 0x4040C7E63FEFA6BA ,\ ; 3.35617141647503099647E+1
        ??.PD_ferf_T2 , 0x405681AA4E9E067F ,\ ; 9.00260197203842689217E+1
        ??.PD_ferf_U2 , 0x40804ADD14C63AEE ,\ ; 5.21357949780152679795E+2
        ??.PD_ferf_T3 , 0x40A17002BCB435B7 ,\ ; 2.23200534594684319226E+3
        ??.PD_ferf_U3 , 0x40B1F252E680FD12 ,\ ; 4.59432382970980127987E+3
        ??.PD_ferf_T4 , 0x40BB5B533C72EF90 ,\ ; 7.00332514112805075473E+3
        ??.PD_ferf_U4 , 0x40D6194001017C0A ,\ ; 2.26290000613890934246E+4
        ??.PD_ferf_T5 , 0x40EB2509A44213DC ,\ ; 5.55923013010394962768E+4
        ??.PD_ferf_U5 , 0x40E80E6C9DC8F567    ; 4.92673942608635921086E+4

$align 16
??.SD_ferf_Tn:
v64bit  ??.SD_ferf_T0 , 0x0000000000000000 ,\ ; 0.0
        ??.SD_ferf_T1 , 0x402335BF1E375D88 ,\ ; 9.60497373987051638749E+0
        ??.SD_ferf_T2 , 0x405681AA4E9E067F ,\ ; 9.00260197203842689217E+1
        ??.SD_ferf_T3 , 0x40A17002BCB435B7 ,\ ; 2.23200534594684319226E+3
        ??.SD_ferf_T4 , 0x40BB5B533C72EF90 ,\ ; 7.00332514112805075473E+3
        ??.SD_ferf_T5 , 0x40EB2509A44213DC    ; 5.55923013010394962768E+4

$align 16
??.SD_ferf_Un:
v64bit  ??.SD_ferf_U0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_ferf_U1 , 0x4040C7E63FEFA6BA ,\ ; 3.35617141647503099647E+1
        ??.SD_ferf_U2 , 0x40804ADD14C63AEE ,\ ; 5.21357949780152679795E+2
        ??.SD_ferf_U3 , 0x40B1F252E680FD12 ,\ ; 4.59432382970980127987E+3
        ??.SD_ferf_U4 , 0x40D6194001017C0A ,\ ; 2.26290000613890934246E+4
        ??.SD_ferf_U5 , 0x40E80E6C9DC8F567    ; 4.92673942608635921086E+4

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fndtr_factor , 0x3FE6A09E667F3BCD ; 0.70710678118654752440084436210485 = 1/SQRT(2)
v64bit  ??.SD_ferf_factor  , 0x3FF20DD750429B6D ; 1.1283791670955125738961589031215  = 2/SQRT(PI)

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; https://keisan.casio.com/exec/system/1180573188
; Normal distribution Calculator
; Calculates the probability density function and lower and upper
; cumulative distribution functions of the normal distribution

; https://keisan.casio.com/exec/system/1180573449
; Error function Calculator
; Calculates the error function erf(x) and complementary error function erfc(x)

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_ferf_max_arg , 0x4017AFD21FF2E48F ; 5.9217
; erf(x) = 1, x >= max_arg
;
; erf(5.9217) = 0.999999999999999944564  = 0x3FF0000000000000
; erf(5.9216) = 0.9999999999999999444974 = 0x3FEFFFFFFFFFFFFF

v64bit  ??.SD_ferf_min_arg , 0xC017AFD21FF2E48F ; -5.9217
; erf(x) = -1, x <= min_arg
;
; erf(-5.9217) = -0.999999999999999944564  = 0xBFF0000000000000
; erf(-5.9216) = -0.9999999999999999444974 = 0xBFEFFFFFFFFFFFFF

v64bit  ??.SD_ferf_eps     , 0x3E50000000000000 ; 2^(-26) = 0.00000001490116119384765625
; erf(x) = (2/sqrt(pi))*x, |x| <= eps
; erf(x) = (2/sqrt(pi))*x, x.exp < -26
;
; erf(2^(-26)) = 1.681415985666979089945E-8
; SIC : (2/sqrt(pi))*(2^(-26))-1.681415985666979089945E-8 = 0x0000000000000000
;
; erf(2^(-25)) = 3.36283197133395743319E-8
; SIC : (2/sqrt(pi))*(2^(-25))-3.36283197133395743319E-8  = 0x3B20000000000000 = 6.6174449004242214E-24

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_ferfc_max_arg , 0x403B369AD42C3C9F ; 27.2133
; erfc(x) = 0, x >= max_arg
;
; erfc(27.2132) = 4.965801760601819728223E-324 | > 2^(-1074)
; erfc(27.2133) = 4.938829931744703814286E-324 | < 2^(-1074)

v64bit  ??.SD_ferfc_min_arg , 0xC017746DC5D63886 ; -5.8637
; erfc(x) = 2, x <= min_arg
;
; erfc(-5.8637) = 1.99999999999999988913  = 0x4000000000000000
; erfc(-5.8636) = 1.999999999999999888998 = 0x3FFFFFFFFFFFFFFF

v64bit  ??.SD_ferfc_eps     , 0x3EC0000000000000 ; 2^(-19) = 0.0000019073486328125
; erfc(x) = 1-(2/sqrt(pi))*x, |x| <= eps
; erfc(x) = 1-(2/sqrt(pi))*x, x.exp < -19
;
; erfc(2^(-19)) = 0.9999978477875383488765
; SIC : (1-(2/sqrt(pi))*(2^(-19)))-0.9999978477875383488765 = 0x0000000000000000
;
; erfc(2^(-18)) = 0.9999956955750767134124
; SIC : (1-(2/sqrt(pi))*(2^(-18)))-0.9999956955750767134124 = 0xBCA0000000000000 = -1.1102230246251565E-16

v64bit  ??.SD_ferfc_eps2    , 0x3C80000000000000 ; 2^(-55) = 2.7755575615628913510590791702271e-17
; erfc(x) = 1, |x| <= eps2
; erfc(x) = 1, x.exp < -55
;
; erfc(+2^(-55)) = 0.9999999999999999686812 = 0x3FF0000000000000
; erfc(-2^(-55)) = 1.000000000000000031319  = 0x3FF0000000000000
;
; erfc(+2^(-54)) = 0.9999999999999999373624 = 0x3FEFFFFFFFFFFFFF
; erfc(-2^(-54)) = 1.000000000000000062638  = 0x3FF0000000000000

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fndtr_max_arg , 0x402095C28F5C28F6 ; 8.2925
; ndtr(x) = 1, x >= max_arg
;
; ndtr(8.2925) = 0.9999999999999999445537 = 0x3FF0000000000000
; ndtr(8.2924) = 0.999999999999999944507  = 0x3FEFFFFFFFFFFFFF

v64bit  ??.SD_fndtr_min_arg , 0xC0433BD70A3D70A4 ; -38.4675
; ndtr(x) = 0, x <= min_arg
;
; ndtr(-38.4674) = 4.941724856393645902117E-324 | > 2^(-1074)
; ndtr(-38.4675) = 4.922739036697021488E-324    | < 2^(-1074)

v64bit  ??.SD_fndtr_eps     , 0x3CA0000000000000 ; 2^(-54) = 1.1102230246251565404236316680908e-16
; ndtr(x) = 0.5, |x| <= eps
; ndtr(x) = 0.5, x.exp < -54
;
; ndtr(+2^(-54)) = 0.5000000000000000221458 = 3FE0000000000000
; ndtr(-2^(-54)) = 0.4999999999999999778543 = 3FE0000000000000
;
; ndtr(+2^(-53)) = 0.5000000000000000442915 = 3FE0000000000000
; ndtr(-2^(-53)) = 0.4999999999999999557085 = 3FDFFFFFFFFFFFFF

; ------------------------------------------------------------------------------
