
; FASM SOURCE FILE
; http://flatassembler.net

; <SI>mple <C>ompiler
; function constants

; Copyright © 2000-3000, Andrey A. Meshkov (AL-CHEMIST)
; All rights reserved
;
; http://maalchemist.ru
; http://maalchemist.narod.ru
; maa@maalchemist.ru
; maalchemist@yandex.ru
; maalchemist@gmail.com

; ------------------------------------------------------------------------------

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/sin.c
; Circular sine
; Circular cosine

; sin(x) = x + (x^3)*P(x^2)
;        = x*(1 + (x^2)*P(x^2))
; 0 <= x < pi/4
;
; sin(x) = x*(
;          1 +                                  // P6
;  (x^2)*(-1.66666666666666307295E-1 +          // P5
;  (x^2)*( 8.33333333332211858878E-3 +          // P4
;  (x^2)*(-1.98412698295895385996E-4 +          // P3
;  (x^2)*( 2.75573136213857245213E-6 +          // P2
;  (x^2)*(-2.50507477628578072866E-8 +          // P1
;  (x^2)*( 1.58962301576546568060E-10 )...)     // P0
;
; sin(x) = x*(
;          1 +                                  // P6
;  (x^2)*(
;  (
;         -1.66666666666666307295E-1 +          // P5
;  (x^2)*( 8.33333333332211858878E-3 +          // P4
;  (x^2)*(-1.98412698295895385996E-4 )...)      // P3
;  +
;  (x^6)*(
;          2.75573136213857245213E-6 +          // P2
;  (x^2)*(-2.50507477628578072866E-8 +          // P1
;  (x^2)*( 1.58962301576546568060E-10 )...)     // P0
;  )

; cos(x) = 1 - 0.5*(x^2) + (x^4)*Q(x^2)
; 0 <= x < pi/4
;
; cos(x) =
;          1 +                                  // Q7
;  (x^2)*(-0.5 +                                // Q6
;  (x^2)*( 4.16666666666665929218E-2 +          // Q5
;  (x^2)*(-1.38888888888730564116E-3 +          // Q4
;  (x^2)*( 2.48015872888517045348E-5 +          // Q3
;  (x^2)*(-2.75573141792967388112E-7 +          // Q2
;  (x^2)*( 2.08757008419747316778E-9 +          // Q1
;  (x^2)*(-1.13585365213876817300E-11 )...)     // Q0
;
; cos(x) =
;          1 +                                  // Q7
;  (x^2)*(-0.5 +                                // Q6
;  (x^2)*( 4.16666666666665929218E-2 +          // Q5
;  (x^2)*(-1.38888888888730564116E-3 )...)      // Q4
;  +
;  (x^8)*(
;          2.48015872888517045348E-5 +          // Q3
;  (x^2)*(-2.75573141792967388112E-7 +          // Q2
;  (x^2)*( 2.08757008419747316778E-9 +          // Q1
;  (x^2)*(-1.13585365213876817300E-11 )...)     // Q0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_fsin_Pn:
v64bit  ??.PD_fsin_P0 , 0x3DE5D8FD1FD19CCD ,\ ;  1.58962301576546568060E-10
        ??.PD_fsin_P3 , 0xBF2A01A019BFDF03 ,\ ; -1.98412698295895385996E-4
        ??.PD_fsin_P1 , 0xBE5AE5E5A9291F5D ,\ ; -2.50507477628578072866E-8
        ??.PD_fsin_P4 , 0x3F8111111110F7D0 ,\ ;  8.33333333332211858878E-3
        ??.PD_fsin_P2 , 0x3EC71DE3567D48A1 ,\ ;  2.75573136213857245213E-6
        ??.PD_fsin_P5 , 0xBFC5555555555548    ; -1.66666666666666307295E-1

$align 16
??.SD_fsin_Pn:
v64bit  ??.SD_fsin_P0 , 0x3DE5D8FD1FD19CCD ,\ ;  1.58962301576546568060E-10
        ??.SD_fsin_P1 , 0xBE5AE5E5A9291F5D ,\ ; -2.50507477628578072866E-8
        ??.SD_fsin_P2 , 0x3EC71DE3567D48A1 ,\ ;  2.75573136213857245213E-6
        ??.SD_fsin_P3 , 0xBF2A01A019BFDF03 ,\ ; -1.98412698295895385996E-4
        ??.SD_fsin_P4 , 0x3F8111111110F7D0 ,\ ;  8.33333333332211858878E-3
        ??.SD_fsin_P5 , 0xBFC5555555555548 ,\ ; -1.66666666666666307295E-1
        ??.SD_fsin_P6 , 0x3FF0000000000000    ;  1.0

$align 16
??.PD_fcos_Qn:
v64bit  ??.PD_fcos_Q0 , 0xBDA8FA49A0861A9B ,\ ; -1.13585365213876817300E-11
        ??.PD_fcos_Q4 , 0xBF56C16C16C14F91 ,\ ; -1.38888888888730564116E-3
        ??.PD_fcos_Q1 , 0x3E21EE9D7B4E3F05 ,\ ;  2.08757008419747316778E-9
        ??.PD_fcos_Q5 , 0x3FA555555555554B ,\ ;  4.16666666666665929218E-2
        ??.PD_fcos_Q2 , 0xBE927E4F7EAC4BC6 ,\ ; -2.75573141792967388112E-7
        ??.PD_fcos_Q6 , 0xBFE0000000000000 ,\ ; -0.5
        ??.PD_fcos_Q3 , 0x3EFA01A019C844F5 ,\ ;  2.48015872888517045348E-5
        ??.PD_fcos_Q7 , 0x3FF0000000000000    ;  1.0

$align 16
??.SD_fcos_Qn:
v64bit  ??.SD_fcos_Q0 , 0xBDA8FA49A0861A9B ,\ ; -1.13585365213876817300E-11
        ??.SD_fcos_Q1 , 0x3E21EE9D7B4E3F05 ,\ ;  2.08757008419747316778E-9
        ??.SD_fcos_Q2 , 0xBE927E4F7EAC4BC6 ,\ ; -2.75573141792967388112E-7
        ??.SD_fcos_Q3 , 0x3EFA01A019C844F5 ,\ ;  2.48015872888517045348E-5
        ??.SD_fcos_Q4 , 0xBF56C16C16C14F91 ,\ ; -1.38888888888730564116E-3
        ??.SD_fcos_Q5 , 0x3FA555555555554B ,\ ;  4.16666666666665929218E-2
        ??.SD_fcos_Q6 , 0xBFE0000000000000 ,\ ; -0.5
        ??.SD_fcos_Q7 , 0x3FF0000000000000    ;  1.0

$align 16
??.PD_fsico_PQ:
v64bit  ??.PD_fsico_P0 , 0x0000000000000000 ,\ ;  0.0
        ??.PD_fsico_Q0 , 0xBDA8FA49A0861A9B ,\ ; -1.13585365213876817300E-11
        ??.PD_fsico_P1 , 0x3DE5D8FD1FD19CCD ,\ ;  1.58962301576546568060E-10
        ??.PD_fsico_Q1 , 0x3E21EE9D7B4E3F05 ,\ ;  2.08757008419747316778E-9
        ??.PD_fsico_P2 , 0xBE5AE5E5A9291F5D ,\ ; -2.50507477628578072866E-8
        ??.PD_fsico_Q2 , 0xBE927E4F7EAC4BC6 ,\ ; -2.75573141792967388112E-7
        ??.PD_fsico_P3 , 0x3EC71DE3567D48A1 ,\ ;  2.75573136213857245213E-6
        ??.PD_fsico_Q3 , 0x3EFA01A019C844F5 ,\ ;  2.48015872888517045348E-5
        ??.PD_fsico_P4 , 0xBF2A01A019BFDF03 ,\ ; -1.98412698295895385996E-4
        ??.PD_fsico_Q4 , 0xBF56C16C16C14F91 ,\ ; -1.38888888888730564116E-3
        ??.PD_fsico_P5 , 0x3F8111111110F7D0 ,\ ;  8.33333333332211858878E-3
        ??.PD_fsico_Q5 , 0x3FA555555555554B ,\ ;  4.16666666666665929218E-2
        ??.PD_fsico_P6 , 0xBFC5555555555548 ,\ ; -1.66666666666666307295E-1
        ??.PD_fsico_Q6 , 0xBFE0000000000000 ,\ ; -0.5
        ??.PD_fsico_P7 , 0x3FF0000000000000 ,\ ;  1.0
        ??.PD_fsico_Q7 , 0x3FF0000000000000    ;  1.0

macro c
{
$align 16
??.PD_fcosi_QP:
v64bit  ??.PD_fcosi_Q0 , 0xBDA8FA49A0861A9B ,\ ; -1.13585365213876817300E-11
        ??.PD_fcosi_P0 , 0x0000000000000000 ,\ ;  0.0
        ??.PD_fcosi_Q1 , 0x3E21EE9D7B4E3F05 ,\ ;  2.08757008419747316778E-9
        ??.PD_fcosi_P1 , 0x3DE5D8FD1FD19CCD ,\ ;  1.58962301576546568060E-10
        ??.PD_fcosi_Q2 , 0xBE927E4F7EAC4BC6 ,\ ; -2.75573141792967388112E-7
        ??.PD_fcosi_P2 , 0xBE5AE5E5A9291F5D ,\ ; -2.50507477628578072866E-8
        ??.PD_fcosi_Q3 , 0x3EFA01A019C844F5 ,\ ;  2.48015872888517045348E-5
        ??.PD_fcosi_P3 , 0x3EC71DE3567D48A1 ,\ ;  2.75573136213857245213E-6
        ??.PD_fcosi_Q4 , 0xBF56C16C16C14F91 ,\ ; -1.38888888888730564116E-3
        ??.PD_fcosi_P4 , 0xBF2A01A019BFDF03 ,\ ; -1.98412698295895385996E-4
        ??.PD_fcosi_Q5 , 0x3FA555555555554B ,\ ;  4.16666666666665929218E-2
        ??.PD_fcosi_P5 , 0x3F8111111110F7D0 ,\ ;  8.33333333332211858878E-3
        ??.PD_fcosi_Q6 , 0xBFE0000000000000 ,\ ; -0.5
        ??.PD_fcosi_P6 , 0xBFC5555555555548 ,\ ; -1.66666666666666307295E-1
        ??.PD_fcosi_Q7 , 0x3FF0000000000000 ,\ ;  1.0
        ??.PD_fcosi_P7 , 0x3FF0000000000000    ;  1.0
}

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

macro c
{
$align 16
??.PD_fsinL_Pn:
v64bit  ??.PD_fsinL_P0 , 0xBD6AAA24713C3ACA ,\ ; -7.5785404094842805756289E-13
        ??.PD_fsinL_P4 , 0xBF2A01A01A018A6D ,\ ; -1.9841269841254799668344E-4
        ??.PD_fsinL_P1 , 0x3DE61208C47CE0CD ,\ ;  1.6058363167320443249231E-10
        ??.PD_fsinL_P5 , 0x3F8111111111110B ,\ ;  8.3333333333333225058715E-3
        ??.PD_fsinL_P2 , 0xBE5AE64528D7E680 ,\ ; -2.5052104881870868784055E-8
        ??.PD_fsinL_P6 , 0xBFC5555555555555 ,\ ; -1.6666666666666666640255E-1
        ??.PD_fsinL_P3 , 0x3EC71DE3A53308B9 ,\ ;  2.7557319214064922217861E-6
        ??.PD_fsinL_P7 , 0x3FF0000000000000    ;  1.0

$align 16
??.SD_fsinL_Pn:
v64bit  ??.SD_fsinL_P0 , 0xBD6AAA24713C3ACA ,\ ; -7.5785404094842805756289E-13
        ??.SD_fsinL_P1 , 0x3DE61208C47CE0CD ,\ ;  1.6058363167320443249231E-10
        ??.SD_fsinL_P2 , 0xBE5AE64528D7E680 ,\ ; -2.5052104881870868784055E-8
        ??.SD_fsinL_P3 , 0x3EC71DE3A53308B9 ,\ ;  2.7557319214064922217861E-6
        ??.SD_fsinL_P4 , 0xBF2A01A01A018A6D ,\ ; -1.9841269841254799668344E-4
        ??.SD_fsinL_P5 , 0x3F8111111111110B ,\ ;  8.3333333333333225058715E-3
        ??.SD_fsinL_P6 , 0xBFC5555555555555 ,\ ; -1.6666666666666666640255E-1
        ??.SD_fsinL_P7 , 0x3FF0000000000000    ;  1.0

$align 16
??.PD_fcosL_Pn:
v64bit  ??.PD_fcosL_P0 , 0x3D2AABD1874DF32F ,\ ;  4.7377507964246204691685E-14
        ??.PD_fcosL_P4 , 0x3EFA01A01A018CCA ,\ ;  2.4801587301570552304991E-5
        ??.PD_fcosL_P1 , 0xBDA9393241EB1E86 ,\ ; -1.1470284843425359765671E-11
        ??.PD_fcosL_P5 , 0xBF56C16C16C16C0F ,\ ; -1.3888888888888872993737E-3
        ??.PD_fcosL_P2 , 0x3E21EED8C90CB3CA ,\ ;  2.0876754287081521758361E-9
        ??.PD_fcosL_P6 , 0x3FA5555555555555 ,\ ;  4.1666666666666666609054E-2
        ??.PD_fcosL_P3 , 0xBE927E4FB75EB8CA ,\ ; -2.7557319214999787979814E-7
        ??.PD_fcosL_P7 , 0x3FF0000000000000    ; -0.5

$align 16
??.SD_fcosL_Pn:
v64bit  ??.SD_fcosL_P0 , 0x3D2AABD1874DF32F ,\ ;  4.7377507964246204691685E-14
        ??.SD_fcosL_P1 , 0xBDA9393241EB1E86 ,\ ; -1.1470284843425359765671E-11
        ??.SD_fcosL_P2 , 0x3E21EED8C90CB3CA ,\ ;  2.0876754287081521758361E-9
        ??.SD_fcosL_P3 , 0xBE927E4FB75EB8CA ,\ ; -2.7557319214999787979814E-7
        ??.SD_fcosL_P4 , 0x3EFA01A01A018CCA ,\ ;  2.4801587301570552304991E-5
        ??.SD_fcosL_P5 , 0xBF56C16C16C16C0F ,\ ; -1.3888888888888872993737E-3
        ??.SD_fcosL_P6 , 0x3FA5555555555555 ,\ ;  4.1666666666666666609054E-2
        ??.SD_fcosL_P7 , 0x3FF0000000000000 ,\ ; -0.5
        ??.SD_fcosL_P8 , 0x3FF0000000000000    ;  1.0
}

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fsin_max_arg , 0x43D921FB54442D18 ; 7244019458077122841.5989278935877 = (2^63-1)*PI/4
;       ??.SD_fsin_max_arg , 0x43D0000000000000 ; 2^(+62) = 4611686018427387904
vdup    ??.SD_fsin_max_arg ,\
        ??.SD_fcos_max_arg ,\
        ??.SD_fsincos_max_arg ,\
        ??.SD_fcossin_max_arg

v64bit  ??.SD_fsin_min_arg , 0xC3D921FB54442D18 ; -7244019458077122842.3843260569851 = -(2^63)*PI/4
vdup    ??.SD_fsin_min_arg ,\
        ??.SD_fcos_min_arg ,\
        ??.SD_fsincos_min_arg ,\
        ??.SD_fcossin_min_arg

v64bit  ??.SX_fsin_eps , 0x3E50000000000000 ; 2^(-26) = 0.000000014901161193847656250
; sin(x) = x, |x| <= eps
; sin(x) = x, x.exp < -26

v64bit  ??.SX_fcos_eps , 0x3E40000000000000 ; 2^(-27) = 0.000000007450580596923828125
; cos(x) = 1, |x| <= eps
; cos(x) = 1, x.exp < -27

v64bit  ??.SX_fsincos_eps , 0x3E40000000000000 ; 2^(-27) = 0.000000007450580596923828125
vdup    ??.SX_fsincos_eps ,\
        ??.SX_fcossin_eps
; sin(x) = x, cos(x) = 1, |x| <= eps
; sin(x) = x, cos(x) = 1, x.exp < -27

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fcossin_DP1 , 0x3CE8469898CC5170 ; 7.85398125648498535156E-01 | domain point #1
v64bit  ??.SD_fcossin_DP2 , 0x3E64442D00000000 ; 3.77489470793079817668E-08 | domain point #2
v64bit  ??.SD_fcossin_DP3 , 0x3CE8469898CC5170 ; 2.69515142907905952645E-15 | domain point #3

; ------------------------------------------------------------------------------
