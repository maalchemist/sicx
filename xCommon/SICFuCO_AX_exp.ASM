
; FASM SOURCE FILE
; http://flatassembler.net

; <SI>mple <C>ompiler
; function constants

; Copyright © 2000-3000, Andrey A. Meshkov (AL-CHEMIST)
; All rights reserved
;
; http://maalchemist.ru
; http://maalchemist.narod.ru
; maa@maalchemist.ru
; maalchemist@yandex.ru
; maalchemist@gmail.com

; ------------------------------------------------------------------------------

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/exp2.c
; Base 2 exponential function

; exp2(x) = 1 + 2*x*P(x^2)/(Q(x^2) - x*P(x^2))
;
; P =      1.51390680115615096133E+3 +  // P2
;   (x^2)*(2.02020656693165307700E+1 +  // P1
;   (x^2)*(2.30933477057345225087E-2 )) // P0
;
; Q =      4.36821166879210612817E+3 +  // Q2
;   (x^2)*(2.33184211722314911771E+2 +  // Q1
;   (x^2)*(1.00000000000000000000E+0 )) // Q0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_fexp2_PQ:
v64bit  ??.PD_fexp2_P0 , 0x3F97A5C8549AEAD3 ,\ ; 2.30933477057345225087E-2
        ??.PD_fexp2_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_fexp2_P1 , 0x403433BA93615BDE ,\ ; 2.02020656693165307700E+1
        ??.PD_fexp2_Q1 , 0x406D25E50FFB5C3C ,\ ; 2.33184211722314911771E+2
        ??.PD_fexp2_P2 , 0x4097A7A0907B7693 ,\ ; 1.51390680115615096133E+3
        ??.PD_fexp2_Q2 , 0x40B110362FED0BAE    ; 4.36821166879210612817E+3

$align 16
??.SD_fexp2_Pn:
v64bit  ??.SD_fexp2_P0 , 0x3F97A5C8549AEAD3 ,\ ; 2.30933477057345225087E-2
        ??.SD_fexp2_P1 , 0x403433BA93615BDE ,\ ; 2.02020656693165307700E+1
        ??.SD_fexp2_P2 , 0x4097A7A0907B7693    ; 1.51390680115615096133E+3

$align 16
??.SD_fexp2_Qn:
v64bit  ??.SD_fexp2_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_fexp2_Q1 , 0x406D25E50FFB5C3C ,\ ; 2.33184211722314911771E+2
        ??.SD_fexp2_Q2 , 0x40B110362FED0BAE    ; 4.36821166879210612817E+3

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

macro c
{
$align 16
??.PD_fexp2L_PQ:
v64bit  ??.PD_fexp2L_P0 , 0x0000000000000000 ,\ ; 0.0
        ??.PD_fexp2L_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_fexp2L_P1 , 0x404E4EB3856D5AE0 ,\ ; 6.0614853552242266094567E+1
        ??.PD_fexp2L_Q1 , 0x409B55269AD3726B ,\ ; 1.7492876999891839021063E+3
        ??.PD_fexp2L_P2 , 0x40DD93BE33E5B8A7 ,\ ; 3.0286971917562792508623E+4
        ??.PD_fexp2L_Q2 , 0x411400B49E0DAE9C ,\ ; 3.2772515434906797273099E+5
        ??.PD_fexp2L_P3 , 0x413FBE805CFA0830 ,\ ; 2.0803843631901852422887E+6
        ??.PD_fexp2L_Q3 , 0x4156E6081A19F756    ; 6.0027204078348487957118E+6

$align 16
??.SD_fexp2L_Pn:
v64bit  ??.SD_fexp2L_P0 , 0x0000000000000000 ,\ ; 0.0
        ??.SD_fexp2L_P1 , 0x404E4EB3856D5AE0 ,\ ; 6.0614853552242266094567E+1
        ??.SD_fexp2L_P2 , 0x40DD93BE33E5B8A7 ,\ ; 3.0286971917562792508623E+4
        ??.SD_fexp2L_P3 , 0x413FBE805CFA0830    ; 2.0803843631901852422887E+6

$align 16
??.SD_fexp2L_Qn:
v64bit  ??.SD_fexp2L_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_fexp2L_Q1 , 0x409B55269AD3726B ,\ ; 1.7492876999891839021063E+3
        ??.SD_fexp2L_Q2 , 0x411400B49E0DAE9C ,\ ; 3.2772515434906797273099E+5
        ??.SD_fexp2L_Q3 , 0x4156E6081A19F756    ; 6.0027204078348487957118E+6
}

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/exp.c
; Exponential function

; exp(x) = 1 + 2*x*P(x^2)/(Q(x^2) - x*P(x^2))
;
; P =      9.99999999999999999910E-1 +   // P3
;   (x^2)*(3.02994407707441961300E-2 +   // P2
;   (x^2)*(1.26177193074810590878E-4 +   // P1
;   (x^2)*(0.00000000000000000000E+0 ))) // P0
;
; Q =      2.00000000000000000009E+0 +   // Q3
;   (x^2)*(2.27265548208155028766E-1 +   // Q2
;   (x^2)*(2.52448340349684104192E-3 +   // Q1
;   (x^2)*(3.00198505138664455042E-6 ))) // Q0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_fexp_PQ:
v64bit  ??.PD_fexp_P0 , 0x0000000000000000 ,\ ; 0.0
        ??.PD_fexp_Q0 , 0x3EC92EB6BC365FA0 ,\ ; 3.00198505138664455042E-6
        ??.PD_fexp_P1 , 0x3F2089CDD5E44BE8 ,\ ; 1.26177193074810590878E-4
        ??.PD_fexp_Q1 , 0x3F64AE39B508B6C0 ,\ ; 2.52448340349684104192E-3
        ??.PD_fexp_P2 , 0x3F9F06D10CCA2C7E ,\ ; 3.02994407707441961300E-2
        ??.PD_fexp_Q2 , 0x3FCD17099887E074 ,\ ; 2.27265548208155028766E-1
        ??.PD_fexp_P3 , 0x3FF0000000000000 ,\ ; 9.99999999999999999910E-1
        ??.PD_fexp_Q3 , 0x4000000000000000    ; 2.00000000000000000009E+0

$align 16
??.SD_fexp_Pn:
v64bit  ??.SD_fexp_P0 , 0x0000000000000000 ,\ ; 0.0
        ??.SD_fexp_P1 , 0x3F2089CDD5E44BE8 ,\ ; 1.26177193074810590878E-4
        ??.SD_fexp_P2 , 0x3F9F06D10CCA2C7E ,\ ; 3.02994407707441961300E-2
        ??.SD_fexp_P3 , 0x3FF0000000000000    ; 9.99999999999999999910E-1

$align 16
??.SD_fexp_Qn:
v64bit  ??.SD_fexp_Q0 , 0x3EC92EB6BC365FA0 ,\ ; 3.00198505138664455042E-6
        ??.SD_fexp_Q1 , 0x3F64AE39B508B6C0 ,\ ; 2.52448340349684104192E-3
        ??.SD_fexp_Q2 , 0x3FCD17099887E074 ,\ ; 2.27265548208155028766E-1
        ??.SD_fexp_Q3 , 0x4000000000000000    ; 2.00000000000000000009E+0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/exp10.c
; Base 10 exponential function (Common antilogarithm)

; exp10(x) = 1 + 2*x*P(x^2)/(Q(x^2) - x*P(x^2))
;
; P =      2.39423741207388267439E+3 +   // P3
;   (x^2)*(4.06717289936872725516E+2 +   // P2
;   (x^2)*(1.17452732554344059015E+1 +   // P1
;   (x^2)*(4.09962519798587023075E-2 ))) // P0
;
; Q =      2.07960819286001865907E+3 +   // Q3
;   (x^2)*(1.27209271178345121210E+3 +   // Q2
;   (x^2)*(8.50936160849306532625E+1 +   // Q1
;   (x^2)*(1.00000000000000000000E+0 ))) // Q0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_fexp10_PQ:
v64bit  ??.PD_fexp10_P0 , 0x3FA4FD75F3062DD4 ,\ ; 4.09962519798587023075E-2
        ??.PD_fexp10_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.PD_fexp10_P1 , 0x40277D9474C55934 ,\ ; 1.17452732554344059015E+1
        ??.PD_fexp10_Q1 , 0x405545FDCE51CA08 ,\ ; 8.50936160849306532625E+1
        ??.PD_fexp10_P2 , 0x40796B7A050349E4 ,\ ; 4.06717289936872725516E+2
        ??.PD_fexp10_Q2 , 0x4093E05EEFD67782 ,\ ; 1.27209271178345121210E+3
        ??.PD_fexp10_P3 , 0x40A2B4798E134A01 ,\ ; 2.39423741207388267439E+3
        ??.PD_fexp10_Q3 , 0x40A03F37650DF6E2    ; 2.07960819286001865907E+3

$align 16
??.SD_fexp10_Pn:
v64bit  ??.SD_fexp10_P0 , 0x3FA4FD75F3062DD4 ,\ ; 4.09962519798587023075E-2
        ??.SD_fexp10_P1 , 0x40277D9474C55934 ,\ ; 1.17452732554344059015E+1
        ??.SD_fexp10_P2 , 0x40796B7A050349E4 ,\ ; 4.06717289936872725516E+2
        ??.SD_fexp10_P3 , 0x40A2B4798E134A01    ; 2.39423741207388267439E+3

$align 16
??.SD_fexp10_Qn:
v64bit  ??.SD_fexp10_Q0 , 0x3FF0000000000000 ,\ ; 1.0
        ??.SD_fexp10_Q1 , 0x405545FDCE51CA08 ,\ ; 8.50936160849306532625E+1
        ??.SD_fexp10_Q2 , 0x4093E05EEFD67782 ,\ ; 1.27209271178345121210E+3
        ??.SD_fexp10_Q3 , 0x40A03F37650DF6E2    ; 2.07960819286001865907E+3

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fexp2_max_arg  , 0x4090000000000000 ;  1024.0

v64bit  ??.SD_fexp2_min_arg  , 0xC090C80000000000 ; -1074.0
;       ??.SD_fexp2_min_arg  , 0xC08FF80000000000 ; -1023.0

v64bit  ??.SX_fexp2_eps      , 0x3CA0000000000000 ;  2^(-53) = 1.1102230246251565404236316680908e-16
; exp2(x) = 1, |x| <= eps
; exp2(x) = 1, x.exp < -53
;
; exp2(2^(-53)) = 1.000000000000000076955 = 0x3FF0000000000000
; exp2(2^(-52)) = 1.00000000000000015391  = 0x3FF0000000000001

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; exp(x) = exp2(z)
; z = x*log2(e)
;
; z:max_arg = x:max_arg*log2(e) = +1024
; x:max_arg = +1024*Ln(2)
;
; z:min_arg = x:min_arg*log2(e) = -1074
; x:min_arg = -1074*Ln(2)

v64bit  ??.SD_fexp_max_arg   , 0x40862E42FEFA39EF ;  709.78271289338399684324569237317 = +1024*Ln(2)

v64bit  ??.SD_fexp_min_arg   , 0xC0874385446D71C3 ; -744.44007192138126231410729844608 = -1074*Ln(2)
;       ??.SD_fexp_min_arg   , 0xC08628B76E3A7B61 ; -709.08956571282405153382846025171 = -1023*Ln(2)
                                                
v64bit  ??.SD_fexp10_max_arg , 0x40734413509F79FF ;  308.25471555991674389886862819788 = +1024*Log10(2)

v64bit  ??.SD_fexp10_min_arg , 0xC07434E6420F4374 ; -323.30621534311580365955557293411 = -1074*Log10(2)
;       ??.SD_fexp10_min_arg , 0xC0733F424BCB5220 ; -307.95368556425276270365488930316 = -1023*Log10(2)

; ------------------------------------------------------------------------------

; (2^1024)^(2^(-61)) = 1.0000000000000003078191837246648 = 0h3FF0000000000001
; (2^1024)^(2^(-62)) = 1.0000000000000001539095918623324 = 0h3FF0000000000001
; (2^1024)^(2^(-63)) = 1.0000000000000000769547959311662 = 0h3FF0000000000000
; (2^1024)^(2^(-64)) = 1.0000000000000000384773979655831 = 0h3FF0000000000000

v64bit  ??.SD_fpow_eps , 0x3C00000000000000 ; 1.0842021724855044340074528008699e-19 = 2^(-63)
; pow(x,y) = 1, |y| <= eps
; pow(x,y) = 1, y.exp < -63

; ------------------------------------------------------------------------------
