
; FASM SOURCE FILE
; http://flatassembler.net

; <SI>mple <C>ompiler
; function constants

; Copyright © 2000-3000, Andrey A. Meshkov (AL-CHEMIST)
; All rights reserved
;
; http://maalchemist.ru
; http://maalchemist.narod.ru
; maa@maalchemist.ru
; maalchemist@yandex.ru
; maalchemist@gmail.com

; ------------------------------------------------------------------------------

; http://www.moshier.net/#Cephes
; http://www.moshier.net/double.zip/atan.c
; Inverse circular tangent (arctangent)
; Quadrant correct inverse circular tangent

; atan(x) = x + (x^3)*P(x^2)/Q(x^2)
;         = x*(1 + (x^2)*P(x^2)/Q(x^2))
;         = x*(1 + P'(x^2)/Q(x^2))
; |x| <= 0.66
;
; atan(x) = pi/2 - atan(z)
; z = 1/x
; |x| > tan(3*pi/8)
;
; atan(x) = pi/4 + atan(z)
; z = (x-1)/(x+1)
; 0.66 < |x| <= tan(3*pi/8)
;
; P =      -6.485021904942025371773E+1 +
;   (x^2)*(-1.228866684490136173410E+2 +
;   (x^2)*(-7.500855792314704667340E+1 +
;   (x^2)*(-1.615753718733365076637E+1 +
;   (x^2)*(-8.750608600031904122785E-1 )...)
;
; P' =      0.000000000000000000000E+0 +
;   (x^2)*(-6.485021904942025371773E+1 +
;   (x^2)*(-1.228866684490136173410E+2 +
;   (x^2)*(-7.500855792314704667340E+1 +
;   (x^2)*(-1.615753718733365076637E+1 +
;   (x^2)*(-8.750608600031904122785E-1 )...)
;
; Q =       1.945506571482613964425E+2 +
;   (x^2)*( 4.853903996359136964868E+2 +
;   (x^2)*( 4.328810604912902668951E+2 +
;   (x^2)*( 1.650270098316988542046E+2 +
;   (x^2)*( 2.485846490142306297962E+1 +
;   (x^2)*( 1.000000000000000000000E+0 )...)

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; x >= 2^53
;
; acot(x)
; = 1/x - 1/(3*x^3) + 1/(5*x^5) + ...
; = u - (u^3)*(1/3) + (u^5)*(1/5) + ... | u = 1/x
; Laurent series
;
; u*
; (
;   1 - (u^2)*(1/3) + (u^4)*(1/5) - (u^6)*(1/7) + (u^8)*(1/9) +
;   (u^10)*(1/11) + (u^12)*(1/13) - (u^14)*(1/15) + (u^16)*(1/17) - (u^18)*(1/19)
; )
;
; u*
; (
;          ( 1    - (u^2)*(1/3)  + (u^4)*(1/5)  - (u^6)*(1/7)  + (u^8)*(1/9)) +
;   (u^10)*(-1/11 + (u^2)*(1/13) - (u^4)*(1/15) + (u^6)*(1/17) - (u^8)*(1/19))
; )

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_fatan_PQ:
v64bit  ??.PD_fatan_P0 , 0xBFEC007FA1F72594 ,\ ; -8.750608600031904122785E-1
        ??.PD_fatan_Q0 , 0x3FF0000000000000 ,\ ;  1.0
        ??.PD_fatan_P1 , 0xC03028545B6B807A ,\ ; -1.615753718733365076637E+1
        ??.PD_fatan_Q1 , 0x4038DBC45B14603C ,\ ;  2.485846490142306297962E+1
        ??.PD_fatan_P2 , 0xC052C08C36880273 ,\ ; -7.500855792314704667340E+1
        ??.PD_fatan_Q2 , 0x4064A0DD43B8FA25 ,\ ;  1.650270098316988542046E+2
        ??.PD_fatan_P3 , 0xC05EB8BF2D05BA25 ,\ ; -1.228866684490136173410E+2
        ??.PD_fatan_Q3 , 0x407B0E18D2E2BE3B ,\ ;  4.328810604912902668951E+2
        ??.PD_fatan_P4 , 0xC0503669FD28EC8E ,\ ; -6.485021904942025371773E+1
        ??.PD_fatan_Q4 , 0x407E563F13B049EA ,\ ;  4.853903996359136964868E+2
        ??.PD_fatan_P5 , 0x0000000000000000 ,\ ;  0.0
        ??.PD_fatan_Q5 , 0x4068519EFBBD62EC    ;  1.945506571482613964425E+2

$align 16
??.SD_fatan_Pn:
v64bit  ??.SD_fatan_P0 , 0xBFEC007FA1F72594 ,\ ; -8.750608600031904122785E-1
        ??.SD_fatan_P1 , 0xC03028545B6B807A ,\ ; -1.615753718733365076637E+1
        ??.SD_fatan_P2 , 0xC052C08C36880273 ,\ ; -7.500855792314704667340E+1
        ??.SD_fatan_P3 , 0xC05EB8BF2D05BA25 ,\ ; -1.228866684490136173410E+2
        ??.SD_fatan_P4 , 0xC0503669FD28EC8E ,\ ; -6.485021904942025371773E+1
        ??.SD_fatan_P5 , 0x0000000000000000    ;  0.0

$align 16
??.SD_fatan_Qn:
v64bit  ??.SD_fatan_Q0 , 0x3FF0000000000000 ,\ ;  1.0
        ??.SD_fatan_Q1 , 0x4038DBC45B14603C ,\ ;  2.485846490142306297962E+1
        ??.SD_fatan_Q2 , 0x4064A0DD43B8FA25 ,\ ;  1.650270098316988542046E+2
        ??.SD_fatan_Q3 , 0x407B0E18D2E2BE3B ,\ ;  4.328810604912902668951E+2
        ??.SD_fatan_Q4 , 0x407E563F13B049EA ,\ ;  4.853903996359136964868E+2
        ??.SD_fatan_Q5 , 0x4068519EFBBD62EC    ;  1.945506571482613964425E+2

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

$align 16
??.PD_facot_Pn:
v64bit  ??.PD_facot_P0 , 0xBFAAF286BCA1AF28 ,\ ; -0.05263157894736842105263157894737 = -1/19
        ??.PD_facot_P5 , 0x3FBC71C71C71C71C ,\ ;  0.11111111111111111111111111111111 =  1/9
        ??.PD_facot_P1 , 0x3FAE1E1E1E1E1E1E ,\ ;  0.05882352941176470588235294117647 =  1/17
        ??.PD_facot_P6 , 0xBFC2492492492492 ,\ ; -0.14285714285714285714285714285714 = -1/7
        ??.PD_facot_P2 , 0xBFB1111111111111 ,\ ; -0.06666666666666666666666666666667 = -1/15
        ??.PD_facot_P7 , 0x3FC999999999999A ,\ ;  0.2                                =  1/5
        ??.PD_facot_P3 , 0x3FB3B13B13B13B14 ,\ ;  0.07692307692307692307692307692308 =  1/13
        ??.PD_facot_P8 , 0xBFD5555555555555 ,\ ; -0.33333333333333333333333333333333 = -1/3
        ??.PD_facot_P4 , 0xBFB745D1745D1746 ,\ ; -0.09090909090909090909090909090909 = -1/11
        ??.PD_facot_P9 , 0x3FF0000000000000    ;  1.0

$align 16
??.SD_facot_Pn:
v64bit  ??.SD_facot_P0 , 0xBFAAF286BCA1AF28 ,\ ; -0.05263157894736842105263157894737 = -1/19
        ??.SD_facot_P1 , 0x3FAE1E1E1E1E1E1E ,\ ;  0.05882352941176470588235294117647 =  1/17
        ??.SD_facot_P2 , 0xBFB1111111111111 ,\ ; -0.06666666666666666666666666666667 = -1/15
        ??.SD_facot_P3 , 0x3FB3B13B13B13B14 ,\ ;  0.07692307692307692307692307692308 =  1/13
        ??.SD_facot_P4 , 0xBFB745D1745D1746 ,\ ; -0.09090909090909090909090909090909 = -1/11
        ??.SD_facot_P5 , 0x3FBC71C71C71C71C ,\ ;  0.11111111111111111111111111111111 =  1/9
        ??.SD_facot_P6 , 0xBFC2492492492492 ,\ ; -0.14285714285714285714285714285714 = -1/7
        ??.SD_facot_P7 , 0x3FC999999999999A ,\ ;  0.2                                =  1/5
        ??.SD_facot_P8 , 0xBFD5555555555555 ,\ ; -0.33333333333333333333333333333333 = -1/3
        ??.SD_facot_P9 , 0x3FF0000000000000    ;  1.0

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

; pi/2 = PIO2 + MOREBITS

v64bit  ??.SD_fatan_more.bits   , 0x3C91A62633145C07 ; 6.123233995736765886130E-17
v64bit  ??.SD_fatan_more.bits.2 , 0x3C81A62633145C07 ; 3.061616997868382943065E-17 | more.bits / 2
v64bit  ??.SD_fatan_2.more.bits , 0x3CA1A62633145C07 ; 1.224646799147353177226E-16 | 2 * more.bits

; - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - - -

v64bit  ??.SD_fatan_T3P8    , 0x4003504F333F9DE6 ;  tan(3*pi/8) = 2.41421356237309504880

v64bit  ??.SD_fatan_max_arg , 0x4340000000000000 ;  2^(+53) =  9007199254740992
; atan(x) = +pi/2, x >= max_arg

v64bit  ??.SD_fatan_min_arg , 0xC340000000000000 ; -2^(+53) = -9007199254740992
; atan(x) = -pi/2, x <= min_arg

v64bit  ??.SX_fatan_eps     , 0x3E40000000000000 ;  2^(-27) = 0.000000007450580596923828125
; atan(x) = x, |x| <= eps
; atan(x) = x, x.exp < -27

; ------------------------------------------------------------------------------
